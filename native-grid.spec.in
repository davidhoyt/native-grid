Name:           native-grid
Version:        @VERSION@
Release:        @RELEASE@%{?dist}
Summary:        Fast, coherent grid computing in C

Group:          System Environment/Daemons
License:        Apache License, v2.0
URL:            https://github.com/davidhoyt/native-grid/
Source0:        https://github.com/davidhoyt/native-grid/files/%{name}-@FULLVERSION@.tar.gz
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

BuildRequires:  libevent-devel
Requires: initscripts
Requires(post): /sbin/chkconfig
Requires(preun): /sbin/chkconfig, /sbin/service
Requires(postun): /sbin/service

%description
native grid provides the software infrastructure for high performance, 
coherent data grid computing.

%prep
%setup -q -n %{name}-@FULLVERSION@


%build
%configure

make %{?_smp_mflags}

%check
make test

%install
rm -rf %{buildroot}
make install DESTDIR=%{buildroot}

%clean
rm -rf %{buildroot}


%post
/sbin/chkconfig --add %{name}

%preun
if [ "$1" = 0 ] ; then
    /sbin/service %{name} stop > /dev/null 2>&1
    /sbin/chkconfig --del %{name}
fi
exit 0

%postun
if [ "$1" -ge 1 ]; then
    /sbin/service %{name} condrestart > /dev/null 2>&1
fi
exit 0


%files
%defattr(-,root,root,-)
%doc AUTHORS ChangeLog COPYING NEWS README doc/CONTRIBUTORS doc/*.txt
%config(noreplace) %{_sysconfdir}/sysconfig/%{name}

%changelog
* Fri Oct 14 2011 David Hoyt <dhoyt@hoytsoft.org> - 0.0.1-1
- Initial project setup.
